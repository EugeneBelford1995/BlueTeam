I'll admit, this thing is very raw and very PoC. I need to abstract out some hard coded things later like our lab's gMSA for Entra Cloud Sync, our lab's DCs, etc.

The long winded explanation of our though process is here, along with what the whitelist in CSV format should look like: https://happycamper84.medium.com/mishkys-blue-team-auditor-aa62c28dc9b4

The Red Team version, with our thought process, is here: https://happycamper84.medium.com/enumerating-abusing-ad-acls-using-mishkys-redteam-abusetool-b147d2ed08d9
